<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valida√ß√£o de Avalia√ß√µes - Portal Sa√∫de</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #60a5fa 100%);
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .status-badge {
            transition: all 0.3s ease;
        }
        .avaliacao-card {
            transition: all 0.3s ease;
        }
        .avaliacao-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .modal {
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Header -->
    <header class="bg-white/10 backdrop-blur-md border-b border-white/20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
                    <button onclick="voltarInicio()" class="text-white hover:text-blue-200 transition duration-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                    </button>
                    <div>
                        <h1 class="text-xl font-bold text-white">Valida√ß√£o de Avalia√ß√µes</h1>
                        <p class="text-blue-100 text-sm" id="municipioUsuario">Campo Grande - MS</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <p class="text-white font-medium" id="nomeUsuario">Dr. Maria Santos</p>
                        <p class="text-blue-100 text-sm">Coordenadora - CRM 67890-MS</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Estat√≠sticas -->
        <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6">
            <div class="glass-card rounded-lg lg:rounded-xl p-4 lg:p-6 shadow-lg">
                <div class="flex items-center">
                    <div class="p-2 lg:p-3 bg-yellow-100 rounded-full flex-shrink-0">
                        <svg class="w-5 h-5 lg:w-6 lg:h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <div class="ml-3 lg:ml-4 min-w-0">
                        <p class="text-xs lg:text-sm font-medium text-gray-600 truncate">Pendentes</p>
                        <p class="text-xl lg:text-2xl font-bold text-gray-900" id="totalPendentes">0</p>
                    </div>
                </div>
            </div>

            <div class="glass-card rounded-lg lg:rounded-xl p-4 lg:p-6 shadow-lg">
                <div class="flex items-center">
                    <div class="p-2 lg:p-3 bg-green-100 rounded-full flex-shrink-0">
                        <svg class="w-5 h-5 lg:w-6 lg:h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <div class="ml-3 lg:ml-4 min-w-0">
                        <p class="text-xs lg:text-sm font-medium text-gray-600 truncate">Aprovadas</p>
                        <p class="text-xl lg:text-2xl font-bold text-gray-900" id="totalAprovadas">0</p>
                    </div>
                </div>
            </div>

            <div class="glass-card rounded-lg lg:rounded-xl p-4 lg:p-6 shadow-lg">
                <div class="flex items-center">
                    <div class="p-2 lg:p-3 bg-red-100 rounded-full flex-shrink-0">
                        <svg class="w-5 h-5 lg:w-6 lg:h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </div>
                    <div class="ml-3 lg:ml-4 min-w-0">
                        <p class="text-xs lg:text-sm font-medium text-gray-600 truncate">Rejeitadas</p>
                        <p class="text-xl lg:text-2xl font-bold text-gray-900" id="totalRejeitadas">0</p>
                    </div>
                </div>
            </div>

            <div class="glass-card rounded-lg lg:rounded-xl p-4 lg:p-6 shadow-lg">
                <div class="flex items-center">
                    <div class="p-2 lg:p-3 bg-blue-100 rounded-full flex-shrink-0">
                        <svg class="w-5 h-5 lg:w-6 lg:h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <div class="ml-3 lg:ml-4 min-w-0">
                        <p class="text-xs lg:text-sm font-medium text-gray-600 truncate">Total</p>
                        <p class="text-xl lg:text-2xl font-bold text-gray-900" id="totalGeral">0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filtros -->
        <div class="glass-card rounded-lg lg:rounded-xl p-4 lg:p-6 shadow-lg mb-6">
            <div class="space-y-4">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    <div>
                        <label for="filtroStatus" class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                        <select id="filtroStatus" onchange="filtrarAvaliacoes()" 
                            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="todos">Todos</option>
                            <option value="pendente" selected>Pendentes</option>
                            <option value="aprovada">Aprovadas</option>
                            <option value="rejeitada">Rejeitadas</option>
                        </select>
                    </div>

                    <div>
                        <label for="filtroData" class="block text-sm font-medium text-gray-700 mb-2">Data</label>
                        <input type="date" id="filtroData" onchange="filtrarAvaliacoes()"
                            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <div>
                        <label for="filtroPaciente" class="block text-sm font-medium text-gray-700 mb-2">Paciente</label>
                        <input type="text" id="filtroPaciente" placeholder="Nome ou CPF" onkeyup="filtrarAvaliacoes()"
                            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <div class="flex items-end">
                        <button onclick="limparFiltros()" 
                            class="w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition duration-200 text-sm">
                            Limpar Filtros
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lista de Avalia√ß√µes -->
        <div class="glass-card rounded-lg lg:rounded-xl p-4 lg:p-6 shadow-lg">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                <h2 class="text-xl lg:text-2xl font-bold text-gray-800">Avalia√ß√µes para Valida√ß√£o</h2>
                <button onclick="atualizarLista()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200 flex items-center text-sm lg:text-base">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Atualizar
                </button>
            </div>

            <div id="listaAvaliacoes" class="space-y-4">
                <!-- Avalia√ß√µes ser√£o carregadas dinamicamente -->
            </div>

            <div id="semAvaliacoes" class="text-center py-12">
                <div class="text-gray-500 text-xl mb-2">üìã</div>
                <div class="text-gray-500 text-lg mb-2">Nenhuma avalia√ß√£o encontrada</div>
                <p class="text-gray-400">As avalia√ß√µes pendentes aparecer√£o aqui</p>
            </div>
        </div>
    </main>

    <!-- Modal de Detalhes -->
    <div id="modalDetalhes" class="hidden fixed inset-0 bg-black bg-opacity-50 modal z-50 flex items-center justify-center p-2 sm:p-4">
        <div class="bg-white rounded-lg lg:rounded-xl max-w-4xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto">
            <div class="p-4 lg:p-6 border-b border-gray-200 sticky top-0 bg-white">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg lg:text-xl font-bold text-gray-800">Detalhes da Avalia√ß√£o</h3>
                    <button onclick="fecharModal()" class="text-gray-500 hover:text-gray-700 p-1">
                        <svg class="w-5 h-5 lg:w-6 lg:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div id="conteudoModal" class="p-4 lg:p-6">
                <!-- Conte√∫do ser√° inserido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Modal de Rejei√ß√£o -->
    <div id="modalRejeicao" class="hidden fixed inset-0 bg-black bg-opacity-50 modal z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg lg:rounded-xl max-w-md w-full mx-4">
            <div class="p-4 lg:p-6 border-b border-gray-200">
                <h3 class="text-lg lg:text-xl font-bold text-gray-800">Rejeitar Avalia√ß√£o</h3>
            </div>
            
            <div class="p-4 lg:p-6">
                <label for="motivoRejeicao" class="block text-sm font-medium text-gray-700 mb-2">Motivo da Rejei√ß√£o</label>
                <textarea id="motivoRejeicao" rows="4" required
                    class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Descreva o motivo da rejei√ß√£o..."></textarea>
                
                <div class="flex flex-col sm:flex-row gap-3 mt-6">
                    <button onclick="fecharModalRejeicao()" 
                        class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition duration-200 text-sm">
                        Cancelar
                    </button>
                    <button onclick="confirmarRejeicao()" 
                        class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg transition duration-200 text-sm">
                        Rejeitar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados do usu√°rio logado
        const usuarioLogado = {
            nome: "Dr. Maria Santos",
            municipio: "Campo Grande - MS",
            cargo: "Coordenadora",
            registro: "CRM 67890-MS"
        };

        // Vari√°veis globais
        let todasAvaliacoes = [];
        let avaliacoesFiltradas = [];
        let avaliacaoParaRejeitar = null;

        // Carregar avalia√ß√µes
        function carregarAvaliacoes() {
            // Carregar avalia√ß√µes pendentes
            const pendentes = JSON.parse(localStorage.getItem('avaliacoesPendentes')) || [];
            
            // Carregar avalia√ß√µes aprovadas
            const aprovadas = JSON.parse(localStorage.getItem('avaliacoesAprovadas')) || [];
            
            // Carregar avalia√ß√µes rejeitadas
            const rejeitadas = JSON.parse(localStorage.getItem('avaliacoesRejeitadas')) || [];

            // Combinar todas as avalia√ß√µes
            todasAvaliacoes = [
                ...pendentes.map(a => ({ ...a, status: 'pendente' })),
                ...aprovadas.map(a => ({ ...a, status: 'aprovada' })),
                ...rejeitadas.map(a => ({ ...a, status: 'rejeitada' }))
            ];

            // Ordenar por data (mais recentes primeiro)
            todasAvaliacoes.sort((a, b) => new Date(b.dataAvaliacao) - new Date(a.dataAvaliacao));

            atualizarEstatisticas();
            filtrarAvaliacoes();
        }

        function atualizarEstatisticas() {
            const pendentes = todasAvaliacoes.filter(a => a.status === 'pendente').length;
            const aprovadas = todasAvaliacoes.filter(a => a.status === 'aprovada').length;
            const rejeitadas = todasAvaliacoes.filter(a => a.status === 'rejeitada').length;
            const total = todasAvaliacoes.length;

            document.getElementById('totalPendentes').textContent = pendentes;
            document.getElementById('totalAprovadas').textContent = aprovadas;
            document.getElementById('totalRejeitadas').textContent = rejeitadas;
            document.getElementById('totalGeral').textContent = total;
        }

        function filtrarAvaliacoes() {
            const filtroStatus = document.getElementById('filtroStatus').value;
            const filtroData = document.getElementById('filtroData').value;
            const filtroPaciente = document.getElementById('filtroPaciente').value.toLowerCase();

            avaliacoesFiltradas = todasAvaliacoes.filter(avaliacao => {
                // Filtro por status
                if (filtroStatus !== 'todos' && avaliacao.status !== filtroStatus) {
                    return false;
                }

                // Filtro por data
                if (filtroData) {
                    const dataAvaliacao = new Date(avaliacao.dataAvaliacao).toISOString().split('T')[0];
                    if (dataAvaliacao !== filtroData) {
                        return false;
                    }
                }

                // Filtro por paciente
                if (filtroPaciente) {
                    const nome = avaliacao.paciente.nomeCompleto.toLowerCase();
                    const cpf = avaliacao.paciente.cpf.replace(/\D/g, '');
                    const filtroLimpo = filtroPaciente.replace(/\D/g, '');
                    
                    if (!nome.includes(filtroPaciente) && !cpf.includes(filtroLimpo)) {
                        return false;
                    }
                }

                return true;
            });

            renderizarAvaliacoes();
        }

        function renderizarAvaliacoes() {
            const container = document.getElementById('listaAvaliacoes');
            const semAvaliacoes = document.getElementById('semAvaliacoes');

            if (avaliacoesFiltradas.length === 0) {
                container.innerHTML = '';
                semAvaliacoes.classList.remove('hidden');
                return;
            }

            semAvaliacoes.classList.add('hidden');

            container.innerHTML = avaliacoesFiltradas.map(avaliacao => {
                const statusColors = {
                    'pendente': 'bg-yellow-100 text-yellow-800 border-yellow-200',
                    'aprovada': 'bg-green-100 text-green-800 border-green-200',
                    'rejeitada': 'bg-red-100 text-red-800 border-red-200'
                };

                const statusTexts = {
                    'pendente': 'Pendente',
                    'aprovada': 'Aprovada',
                    'rejeitada': 'Rejeitada'
                };

                return `
                    <div class="avaliacao-card border border-gray-200 rounded-lg p-4 lg:p-6 hover:bg-gray-50">
                        <div class="space-y-4">
                            <!-- Header do Card -->
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-3">
                                <div class="flex-1 min-w-0">
                                    <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-2">
                                        <h3 class="text-base lg:text-lg font-medium text-gray-800 truncate">${avaliacao.paciente.nomeCompleto}</h3>
                                        <span class="status-badge px-2 py-1 rounded-full text-xs font-medium border ${statusColors[avaliacao.status]} w-fit">
                                            ${statusTexts[avaliacao.status]}
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <!-- Informa√ß√µes do Paciente -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-sm text-gray-600">
                                <div class="flex flex-col">
                                    <span class="font-medium text-gray-700">CPF</span>
                                    <span>${avaliacao.paciente.cpf}</span>
                                </div>
                                <div class="flex flex-col">
                                    <span class="font-medium text-gray-700">Idade</span>
                                    <span>${avaliacao.paciente.idade} anos</span>
                                </div>
                                <div class="flex flex-col">
                                    <span class="font-medium text-gray-700">Avaliador</span>
                                    <span class="truncate">${avaliacao.avaliadorPor}</span>
                                </div>
                                <div class="flex flex-col">
                                    <span class="font-medium text-gray-700">Data</span>
                                    <span>${new Date(avaliacao.dataAvaliacao).toLocaleDateString('pt-BR')}</span>
                                </div>
                            </div>

                            <!-- Resultados -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 lg:p-4">
                                    <h4 class="font-medium text-blue-800 mb-2 text-sm lg:text-base">IVCF-20</h4>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xl lg:text-2xl font-bold text-blue-600">${avaliacao.ivcf.resultado.pontuacao}</span>
                                        <span class="text-xs lg:text-sm text-blue-700 text-right">${avaliacao.ivcf.resultado.classificacao}</span>
                                    </div>
                                </div>

                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 lg:p-4">
                                    <h4 class="font-medium text-green-800 mb-2 text-sm lg:text-base">IVSF-10</h4>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xl lg:text-2xl font-bold text-green-600">${avaliacao.ivsf.resultado.pontuacao}</span>
                                        <span class="text-xs lg:text-sm text-green-700 text-right">${avaliacao.ivsf.resultado.classificacao}</span>
                                    </div>
                                </div>
                            </div>

                            ${avaliacao.motivoRejeicao ? `
                                <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                    <p class="text-sm text-red-700"><strong>Motivo da Rejei√ß√£o:</strong> ${avaliacao.motivoRejeicao}</p>
                                </div>
                            ` : ''}

                            <!-- Bot√µes de A√ß√£o -->
                            <div class="flex flex-col sm:flex-row gap-2">
                                <button onclick="verDetalhes(${avaliacao.id})" 
                                    class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200 text-sm">
                                    Ver Detalhes
                                </button>
                                
                                ${avaliacao.status === 'pendente' ? `
                                    <button onclick="aprovarAvaliacao(${avaliacao.id})" 
                                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 text-sm">
                                        ‚úì Aprovar
                                    </button>
                                    <button onclick="abrirModalRejeicao(${avaliacao.id})" 
                                        class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition duration-200 text-sm">
                                        ‚úó Rejeitar
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function verDetalhes(id) {
            const avaliacao = todasAvaliacoes.find(a => a.id === id);
            if (!avaliacao) return;

            const questoesIVCF = [
                "Qual a idade do idoso?",
                "Como o(a) senhor(a) avalia sua sa√∫de hoje?",
                "Nos √∫ltimos 12 meses, quantas vezes o(a) senhor(a) foi internado(a)?",
                "Quantas consultas m√©dicas realizou nos √∫ltimos 12 meses?",
                "Teve alguma queda no √∫ltimo ano?",
                "Tem dificuldade para enxergar?",
                "Tem dificuldade para ouvir?",
                "Tem perda involunt√°ria de urina?",
                "Apresenta esquecimento frequente?",
                "Sente-se triste ou desanimado frequentemente?",
                "Faz algum tipo de atividade f√≠sica regularmente?",
                "Quantos medicamentos diferentes utiliza por dia?",
                "Consegue tomar banho sozinho(a)?",
                "Consegue vestir-se sozinho(a)?",
                "Consegue alimentar-se sozinho(a)?",
                "Consegue ir ao banheiro sozinho(a)?",
                "Consegue andar dentro de casa sem ajuda?",
                "Consegue subir um lance de escada?",
                "Consegue sair de casa sozinho(a)?",
                "Mora sozinho(a) ou tem quem o(a) ajude se necess√°rio?"
            ];

            const questoesIVSF = [
                "Quantas pessoas moram na resid√™ncia?",
                "H√° outros idosos no domic√≠lio?",
                "H√° crian√ßas menores de 6 anos?",
                "H√° gestante na casa?",
                "Algum morador tem doen√ßa cr√¥nica ou defici√™ncia?",
                "H√° pessoas analfabetas na fam√≠lia?",
                "Qual a renda per capita da fam√≠lia?",
                "O domic√≠lio √© pr√≥prio, alugado ou cedido?",
                "A casa tem acesso a √°gua tratada e esgoto?",
                "A fam√≠lia consegue acesso adequado a servi√ßos de sa√∫de?"
            ];

            let conteudo = `
                <div class="space-y-4 lg:space-y-6">
                    <!-- Dados do Paciente -->
                    <div class="bg-gray-50 rounded-lg p-3 lg:p-4">
                        <h4 class="font-bold text-gray-800 mb-3 text-sm lg:text-base">Dados do Paciente</h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs lg:text-sm">
                            <div><strong>Nome:</strong> ${avaliacao.paciente.nomeCompleto}</div>
                            <div><strong>CPF:</strong> ${avaliacao.paciente.cpf}</div>
                            <div><strong>Idade:</strong> ${avaliacao.paciente.idade} anos</div>
                            <div><strong>Telefone:</strong> ${avaliacao.paciente.telefone}</div>
                        </div>
                    </div>

                    <!-- Resultados -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 lg:p-4">
                            <h4 class="font-bold text-blue-800 mb-2 text-sm lg:text-base">IVCF-20</h4>
                            <div class="text-center">
                                <div class="text-2xl lg:text-3xl font-bold text-blue-600">${avaliacao.ivcf.resultado.pontuacao}</div>
                                <div class="text-xs lg:text-sm text-blue-700">${avaliacao.ivcf.resultado.classificacao}</div>
                            </div>
                        </div>

                        <div class="bg-green-50 border border-green-200 rounded-lg p-3 lg:p-4">
                            <h4 class="font-bold text-green-800 mb-2 text-sm lg:text-base">IVSF-10</h4>
                            <div class="text-center">
                                <div class="text-2xl lg:text-3xl font-bold text-green-600">${avaliacao.ivsf.resultado.pontuacao}</div>
                                <div class="text-xs lg:text-sm text-green-700">${avaliacao.ivsf.resultado.classificacao}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Respostas IVCF -->
                    <div class="bg-blue-50 rounded-lg p-3 lg:p-4">
                        <h4 class="font-bold text-blue-800 mb-3 text-sm lg:text-base">Respostas IVCF-20</h4>
                        <div class="space-y-2 text-xs lg:text-sm">
            `;

            Object.entries(avaliacao.ivcf.respostas).forEach(([indice, resposta]) => {
                conteudo += `
                    <div class="flex flex-col sm:flex-row sm:justify-between gap-1 sm:gap-2 py-1">
                        <span class="text-gray-700 flex-1">${parseInt(indice) + 1}. ${questoesIVCF[parseInt(indice)]}</span>
                        <span class="font-medium text-blue-600 sm:text-right">${resposta}</span>
                    </div>
                `;
            });

            conteudo += `
                        </div>
                    </div>

                    <!-- Respostas IVSF -->
                    <div class="bg-green-50 rounded-lg p-3 lg:p-4">
                        <h4 class="font-bold text-green-800 mb-3 text-sm lg:text-base">Respostas IVSF-10</h4>
                        <div class="space-y-2 text-xs lg:text-sm">
            `;

            Object.entries(avaliacao.ivsf.respostas).forEach(([indice, resposta]) => {
                conteudo += `
                    <div class="flex flex-col sm:flex-row sm:justify-between gap-1 sm:gap-2 py-1">
                        <span class="text-gray-700 flex-1">${parseInt(indice) + 1}. ${questoesIVSF[parseInt(indice)]}</span>
                        <span class="font-medium text-green-600 sm:text-right">${resposta}</span>
                    </div>
                `;
            });

            conteudo += `
                        </div>
                    </div>

                    <!-- Informa√ß√µes da Avalia√ß√£o -->
                    <div class="bg-gray-50 rounded-lg p-3 lg:p-4">
                        <h4 class="font-bold text-gray-800 mb-3 text-sm lg:text-base">Informa√ß√µes da Avalia√ß√£o</h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs lg:text-sm">
                            <div><strong>Avaliador:</strong> ${avaliacao.avaliadorPor}</div>
                            <div><strong>Data:</strong> ${new Date(avaliacao.dataAvaliacao).toLocaleString('pt-BR')}</div>
                            <div><strong>Munic√≠pio:</strong> ${avaliacao.municipio}</div>
                            <div><strong>Status:</strong> ${avaliacao.status}</div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('conteudoModal').innerHTML = conteudo;
            document.getElementById('modalDetalhes').classList.remove('hidden');
        }

        function fecharModal() {
            document.getElementById('modalDetalhes').classList.add('hidden');
        }

        function aprovarAvaliacao(id) {
            if (!confirm('Tem certeza que deseja aprovar esta avalia√ß√£o?')) {
                return;
            }

            // Encontrar a avalia√ß√£o
            const avaliacao = todasAvaliacoes.find(a => a.id === id);
            if (!avaliacao) return;

            // Remover das pendentes
            let pendentes = JSON.parse(localStorage.getItem('avaliacoesPendentes')) || [];
            pendentes = pendentes.filter(a => a.id !== id);
            localStorage.setItem('avaliacoesPendentes', JSON.stringify(pendentes));

            // Adicionar √†s aprovadas
            let aprovadas = JSON.parse(localStorage.getItem('avaliacoesAprovadas')) || [];
            avaliacao.status = 'aprovada';
            avaliacao.dataAprovacao = new Date().toISOString();
            avaliacao.aprovadoPor = usuarioLogado.nome;
            aprovadas.unshift(avaliacao);
            localStorage.setItem('avaliacoesAprovadas', JSON.stringify(aprovadas));

            alert('Avalia√ß√£o aprovada com sucesso!');
            carregarAvaliacoes();
        }

        function abrirModalRejeicao(id) {
            avaliacaoParaRejeitar = id;
            document.getElementById('motivoRejeicao').value = '';
            document.getElementById('modalRejeicao').classList.remove('hidden');
        }

        function fecharModalRejeicao() {
            avaliacaoParaRejeitar = null;
            document.getElementById('modalRejeicao').classList.add('hidden');
        }

        function confirmarRejeicao() {
            const motivo = document.getElementById('motivoRejeicao').value.trim();
            if (!motivo) {
                alert('Por favor, informe o motivo da rejei√ß√£o.');
                return;
            }

            // Encontrar a avalia√ß√£o
            const avaliacao = todasAvaliacoes.find(a => a.id === avaliacaoParaRejeitar);
            if (!avaliacao) return;

            // Remover das pendentes
            let pendentes = JSON.parse(localStorage.getItem('avaliacoesPendentes')) || [];
            pendentes = pendentes.filter(a => a.id !== avaliacaoParaRejeitar);
            localStorage.setItem('avaliacoesPendentes', JSON.stringify(pendentes));

            // Adicionar √†s rejeitadas
            let rejeitadas = JSON.parse(localStorage.getItem('avaliacoesRejeitadas')) || [];
            avaliacao.status = 'rejeitada';
            avaliacao.dataRejeicao = new Date().toISOString();
            avaliacao.rejeitadoPor = usuarioLogado.nome;
            avaliacao.motivoRejeicao = motivo;
            rejeitadas.unshift(avaliacao);
            localStorage.setItem('avaliacoesRejeitadas', JSON.stringify(rejeitadas));

            alert('Avalia√ß√£o rejeitada com sucesso!');
            fecharModalRejeicao();
            carregarAvaliacoes();
        }

        function limparFiltros() {
            document.getElementById('filtroStatus').value = 'pendente';
            document.getElementById('filtroData').value = '';
            document.getElementById('filtroPaciente').value = '';
            filtrarAvaliacoes();
        }

        function atualizarLista() {
            carregarAvaliacoes();
        }

        function voltarInicio() {
            alert('Voltando para inicio.html...');
            // Em um sistema real: window.location.href = 'inicio.html';
        }

        // Inicializar p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            // Definir informa√ß√µes do usu√°rio
            document.getElementById('nomeUsuario').textContent = usuarioLogado.nome;
            document.getElementById('municipioUsuario').textContent = usuarioLogado.municipio;
            
            // Carregar avalia√ß√µes
            carregarAvaliacoes();
        });

        // Fechar modais ao clicar fora
        document.getElementById('modalDetalhes').addEventListener('click', function(e) {
            if (e.target === this) {
                fecharModal();
            }
        });

        document.getElementById('modalRejeicao').addEventListener('click', function(e) {
            if (e.target === this) {
                fecharModalRejeicao();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'981287ed6694e012',t:'MTc1ODIxNjIwNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
